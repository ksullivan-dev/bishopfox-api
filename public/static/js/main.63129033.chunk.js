(this["webpackJsonpbishopfox-www"]=this["webpackJsonpbishopfox-www"]||[]).push([[0],{116:function(e,t,a){e.exports={darkgreen:"#17571c",lightgreen:"#45a44d",brown:"#6c3f32",offwhite:"#fafafa",text:"#242424",lightgray:"#f3eff7",darkgray:"#a2a2a2",primary:"#59327e",darkprimary:"#3f2459",secondary:"#3f2459",darkbkg:"#242424"}},248:function(e,t,a){e.exports=a(419)},253:function(e,t,a){e.exports={darkgreen:"#17571c",lightgreen:"#45a44d",brown:"#6c3f32",offwhite:"#fafafa",text:"#242424",lightgray:"#f3eff7",darkgray:"#a2a2a2",primary:"#59327e",darkprimary:"#3f2459",secondary:"#3f2459",darkbkg:"#242424"}},415:function(e,t,a){},419:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(56),o=a.n(c),l=a(55),s=(a(253),a(49)),i=a(17),u=a.n(i),m=a(28),p=a(27),d=a(438),f=a(439),b=a(78),h=function(e){return e.charAt(0).toUpperCase()+e.toLowerCase().slice(1)},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return r.a.createElement(t,{dangerouslySetInnerHTML:{__html:e}})},E=function(e){var t=new FormData;return function e(t,a,n){if(!a||"object"!==typeof a||a instanceof Date||a instanceof File){var r=null==a?"":a;t.append(n,r)}else Object.keys(a).forEach((function(r){e(t,a[r],n?"".concat(n,"[").concat(r,"]"):r)}))}(t,e),t},v=function(e){for(var t="".concat(e,"="),a=document.cookie.split(";"),n=0;n<a.length;n+=1){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},y=function(e){return e.trim().toLowerCase().replace(/\s/g,"_")};function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,r,c,o,l,s,i,m,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,n=t.body,r=t.headers,c=t.method,o=void 0===c?"POST":c,l=t.noContentType,s=decodeURIComponent(v("X-CSRF-Token")),r=j({"Content-Type":"application/json","X-CSRF-Token":s},r),l&&delete r["Content-Type"],"application/json"===r["Content-Type"]&&(n=JSON.stringify(n)),e.prev=5,e.next=8,fetch(a,{method:o,body:n,headers:r});case 8:if(!(i=e.sent).ok){e.next=14;break}return e.next=12,i.json();case 12:return m=e.sent,e.abrupt("return",m);case 14:return p=new Error(i.statusText||i.status),e.next=17,i.json();case 17:throw p.response=e.sent,p;case 21:return e.prev=21,e.t0=e.catch(5),console.log(e.t0.response),e.abrupt("return",e.t0);case 25:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t){return e.apply(this,arguments)}}(),w=function(e,t,a){setTimeout(Object(m.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e instanceof Error)){n.next=4;break}a(e),n.next=11;break;case 4:if(!e.redirect){n.next=10;break}return n.next=7,e.redirect_url;case 7:window.location.href=n.sent,n.next=11;break;case 10:t(e);case 11:case"end":return n.stop()}}),n)}))),400)},x={scans:"".concat("http://localhost:3000/api/v1","/scans")}.scans,S=a(6),C=a.n(S),P=a(437),T=a(429),N=(C.a.bool,C.a.object,C.a.node,function(e){var t=e.loading,a=void 0===t||t,n=e.loadingProps,c=void 0===n?{}:n,o=e.children,l=e.container,s=void 0===l||l,i=s?"loader-container":"";return i+=s&&a?"--active":"",r.a.createElement("div",{className:i},r.a.createElement(P.a,{inverted:!0,active:a},r.a.createElement(T.a,c)),o)}),_=a(46),F=a.n(_),D=a(435),A=(C.a.string,C.a.bool,C.a.number,C.a.oneOfType,function(e){var t=e.title,a=e.value,n=e.linebreak,c=e.bold;return a?r.a.createElement(r.a.Fragment,null,c&&g("<strong>".concat(t,"</strong>: ").concat(a)),!c&&"".concat(t,": ").concat(a),n&&r.a.createElement("br",null)):null}),L=function(e){var t=e.scans,a=Object(s.f)(),n=function(e,t){return a.push("/scans/".concat(t["data-scanid"]))};return r.a.createElement(D.a.Group,null,t.map((function(e){return r.a.createElement(D.a,{onClick:n,"data-testid":"scans","data-scanid":e.id,key:e.id},r.a.createElement(D.a.Content,null,r.a.createElement(D.a.Header,{content:F()(1e3*e.start_time).format("MMM D, YYYY")}),r.a.createElement(D.a.Meta,null,r.a.createElement(A,{title:"Hosts Scanned",value:e.hosts_up+e.hosts_down,linebreak:!0,bold:!0}),r.a.createElement(A,{title:"Hosts Up",value:e.hosts_up.toString(),linebreak:!0}),r.a.createElement(A,{title:"Hosts Down",value:e.hosts_down.toString(),linebreak:!0}))))})))},H=a(432),M=a(83),Y=a(430),R=a(82),z=(C.a.string,C.a.func,C.a.bool,C.a.array,C.a.oneOfType,C.a.object,function(e){var t=e.label,a=e.placeholder,n=void 0===a?t:a,c=e.name,o=void 0===c?y(t):c,l=e.onChange,s=e.inputLabel,i=e.labelPosition,u=void 0===i?"left":i,m=e.autoComplete,p=void 0===m?o:m,d=e.fluid,f=void 0===d||d,b=e.inputType,h=void 0===b?"input":b,g=e.options,E=e.dataArray,v=e.id,O=e.allowLP,j=e.accept,k=Object(M.a)(e,["label","placeholder","name","onChange","inputLabel","labelPosition","autoComplete","fluid","inputType","options","dataArray","id","allowLP","accept"]),w=O?void 0:r.a.createElement("input",{"data-lpignore":"true"});return r.a.createElement(r.a.Fragment,null,"input"===h&&r.a.createElement(H.a.Field,null,r.a.createElement("label",{htmlFor:o},t),r.a.createElement(Y.a,Object.assign({},k,{label:s,input:w,placeholder:n,name:o,onChange:l,labelPosition:u,autoComplete:p,fluid:f}))),"textarea"===h&&r.a.createElement(H.a.TextArea,Object.assign({},k,{label:t,placeholder:n,name:o,onChange:l})),"select"===h&&r.a.createElement(H.a.Select,Object.assign({selectOnBlur:!1,selectOnNavigation:!1},k,{placeholder:n,label:t,name:o,onChange:l,options:g,fluid:f,onFocus:function(e){return e.target.setAttribute("autocomplete",o)}})),"checkbox"===h&&r.a.createElement(H.a.Checkbox,Object.assign({},k,{label:t,name:o,onChange:l})),"radio"===h&&E.map((function(e){return r.a.createElement(H.a.Radio,Object.assign({},k,{key:e.label,label:e.label,name:o,value:e.value,checked:e.checked,onChange:l}))})),"file"===h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a.Input,Object.assign({},k,{type:"file",onChange:l,className:"input-file",id:v,label:"",name:o,input:r.a.createElement("input",{accept:j})})),r.a.createElement(R.a,{htmlFor:v,className:"ui primary button",as:"label",content:t,icon:"plus"})))}),I=(C.a.func,function(e){var t=e.updateLoading,a=function(){return t({status:!1})},n=function(){return t({status:!1})},c=function(){var e=Object(m.a)(u.a.mark((function e(r){var c,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({status:!0,text:"Processing Scan..."}),c=E(r),o=x,e.next=5,k({url:o,body:c,noContentType:!0});case 5:l=e.sent,w(l,a,n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(m.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t.target.files).length>0&&c({imported_file:a[0]});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(H.a,null,r.a.createElement(z,{inputType:"file",name:"importScan",label:"Import Scan",onChange:o,id:"import-scan",accept:".xml"}))}),B=a(58),J=a(116),G=a.n(J),U=function(e){var t=e.children,a={color:G.a.darkgray};return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{name:"file alternate",size:"huge",style:a}),r.a.createElement(d.a,{as:"h2",content:"Oh No!"}),r.a.createElement("p",{style:{maxWidth:400,marginLeft:"auto",marginRight:"auto",fontSize:18}},g("It looks like you haven't uploaded any scans. Import one below to get started.")),t)},W=function(){var e=Object(n.useState)({status:!0,text:"Fetching Scans..."}),t=Object(p.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),l=Object(p.a)(o,2),s=l[0],i=l[1],b=Object(n.useState)(!1),h=Object(p.a)(b,2),g=h[0],E=h[1];Object(n.useEffect)((function(){var e=function(){var e=Object(m.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=x,e.next=3,k({url:t,method:"GET"});case 3:a=e.sent,E(!0),c({status:!1}),i(a.scans);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=setTimeout((function(){return e()}),400);return function(){clearTimeout(t)}}),[]);var v=!s.length&&g,y=s.length>0&&g;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-section","data-testid":"single-scan"},r.a.createElement(d.a,{content:"Recent Scans",as:"h2"})),r.a.createElement(N,{loading:a.status,loadingProps:{size:"huge",content:a.text}},r.a.createElement(f.a,{secondary:!0,textAlign:"center",padded:"very"},v&&r.a.createElement(U,null,r.a.createElement(I,{updateLoading:c})),y&&r.a.createElement(L,{scans:s})),y&&r.a.createElement(I,{updateLoading:c})))},X=a(420),q=a(433),K=function(e){var t=e.scan,a=t.id,c=Object(n.useState)(!1),o=Object(p.a)(c,2),l=o[0],s=o[1],i=function(){var e=Object(m.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(x,"/").concat(a),e.next=3,k({url:t,method:"DELETE"});case 3:n=e.sent,w(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(X.a,{content:"Delete Scan",onClick:function(){return s(!0)},negative:!0}),r.a.createElement(q.a,{"data-testid":"test_show-confirm",header:"Delete scan from ".concat(F()(1e3*t.start_time).format("MMM D, YYYY")),open:l,onCancel:function(){return s(!1)},onConfirm:i,size:"mini",content:"This action cannot be undone. Please confirm that you do want to delete this scan.",confirmButton:{content:"Delete Scan",negative:!0,primary:!1,"data-testid":"test_actually-delete"}}))},Q=a(81),V=a(436),Z=a(431),$=(a(415),C.a.node,C.a.string,C.a.object,function(e){var t=e.content,a=e.children,n=e.className,c=void 0===n?"":n,o=e.style;return a&&(t=a),r.a.createElement("span",{className:"".concat(c," text--truncate"),style:o,title:t},t)}),ee=a(234),te=a(235),ae=a(237),ne=a(236),re=a(239);function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(a,!0).forEach((function(t){Object(b.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var le=function(e){function t(){var e,a;Object(ee.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(ae.a)(this,(e=Object(ne.a)(t)).call.apply(e,[this].concat(c)))).transformBoolsToStrings=function(e){return Object.keys(e).reduce((function(t,a){var n=oe({},t);return!0===e[a]?n.bools=[].concat(Object(Q.a)(t.bools),["flex-parent__".concat(a.toLowerCase())]):!1!==e[a]&&(n.props=[].concat(Object(Q.a)(t.props),[Object(b.a)({},a,e[a])])),n}),{bools:[],props:[]})},a.flexChildren=function(e,t){return r.a.Children.map(e,(function(e){if(e){var a=e.props,n=a.className,c=void 0===n?"":n,o=a.flex,l=Object(M.a)(a,["className","flex"]),s="";return o&&(s=" flex-child__".concat(o)),t&&(l.style=oe({},l.style,{padding:"0 ".concat(t,"px")})),r.a.cloneElement(e,oe({},l,{className:c+s}))}return null}))},a.buildFlexClasses=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a="flex-parent";return t.length&&(a=t.join(" ")),a+=" ".concat(e)},a}return Object(re.a)(t,e),Object(te.a)(t,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.children,n=e.as,c=void 0===n?"div":n,o=e.spacing,l=Object(M.a)(e,["className","children","as","spacing"]),s=this.transformBoolsToStrings(l),i=this.buildFlexClasses(t,s.bools);o&&(s.props.style=oe({},s.props.style,{margin:"0 -".concat(o,"px")}));var u=this.flexChildren(a,o);return r.a.createElement(c,oe({},s.props,{className:i}),[u])}}]),t}(n.Component),se=(C.a.string,C.a.node,C.a.bool,C.a.object,C.a.oneOfType,C.a.number,le),ie=function(e){return F()(1e3*e).format("HH:mm:ss")},ue=[{title:"Hostname",name:"hostnames",formatter:function(e){var t=JSON.parse(e);return Array.isArray(t)&&t[0]?t.join(";"):""}},{title:"IP4 Address",name:"ip4_addr"},{title:"Scan Start",name:"starttime",formatter:ie},{title:"Scan End",name:"endtime",formatter:ie}],me=function(e){var t=e.host;return r.a.createElement(r.a.Fragment,null,ue.map((function(e){var a=e.title,n=e.name,c=e.formatter,o=t[n];return c&&(o=c(o)),r.a.createElement(A,{key:n,title:a,value:o,bold:!0,linebreak:!0})})))},pe=[{title:"Port Number",name:"num"},{title:"Proto",name:"proto"},{title:"Service",name:"service_name"},{title:"Reason",name:"reason"},{title:"State",name:"state"}],de=function(e){var t=e.port;return r.a.createElement("div",{className:"port port--".concat(t.state)},pe.map((function(e){var a=e.title,n=e.name,c=t[n];return r.a.createElement(A,{key:n,title:a,value:c,bold:!0,linebreak:!0})})))},fe=function(e){var t=e.hosts,a=t.map((function(e){return e.id})),c=Object(n.useState)([]),o=Object(p.a)(c,2),l=o[0],s=o[1],i=function(e,t){s((function(e){var a=t["data-hostid"];return e.includes(a)?e.filter((function(e){return e!==a})):[a].concat(Object(Q.a)(e))}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{content:"Hosts",as:"h3"}),r.a.createElement(X.a.Group,{size:"small",compact:!0},r.a.createElement(X.a,{content:"Expand All",onClick:function(){return s(a)}}),r.a.createElement(X.a,{content:"Collapse All",onClick:function(){return s([])}})),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(V.a,null,t.map((function(e){var t=e.hostnames,a=JSON.parse(t),n=e.ip4_addr;Array.isArray(a)&&a[0]&&(n=a[0]);var c=l.includes(e.id);return r.a.createElement(D.a,{key:e.id,fluid:!0},r.a.createElement(D.a.Content,null,r.a.createElement(D.a.Header,null,r.a.createElement(V.a.Title,{active:c,onClick:i,"data-hostid":e.id,"data-testid":"host-trigger"},r.a.createElement($,null,r.a.createElement(B.a,{name:"dropdown"}),n))),r.a.createElement(D.a.Meta,null,r.a.createElement(A,{title:"Status",value:h(e.status),bold:!0,linebreak:!0}),c&&r.a.createElement(me,{host:e})),c&&r.a.createElement(D.a.Description,null,r.a.createElement(Z.a,null),r.a.createElement(d.a,{as:"h4",content:"Ports","data-testid":"host-details".concat(e.id)}),r.a.createElement(se,{spacing:"10",wrap:!0},e.ports.map((function(e){return r.a.createElement("div",{flex:"25",key:e.id,style:{minWidth:220}},r.a.createElement(de,{port:e,key:e.id}),r.a.createElement("br",null))}))))))}))))},be=function(){var e=Object(n.useState)({status:!1}),t=Object(p.a)(e,2),a=t[0],c=t[1],o={color:G.a.darkgray};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-section"},r.a.createElement(d.a,{content:"Page Not Found",as:"h2"})),r.a.createElement(N,{loading:a.status,loadingProps:{size:"huge",content:a.text}},r.a.createElement(f.a,{secondary:!0,textAlign:"center",padded:"very"},r.a.createElement(B.a,{name:"file alternate",size:"huge",style:o}),r.a.createElement(d.a,{as:"h2",content:"Oh No!"}),r.a.createElement("p",{style:{maxWidth:400,marginLeft:"auto",marginRight:"auto",fontSize:18}},g('I couldn\'t find what you were looking for. But maybe you wanted\n               to upload a scan. Or <a href="/">view your existing scans</a>.')),r.a.createElement(I,{updateLoading:c}))))},he=function(){var e=Object(s.g)().id,t=Object(n.useState)(!0),a=Object(p.a)(t,2),c=a[0],o=a[1],i=Object(n.useState)(),f=Object(p.a)(i,2),b=f[0],h=f[1],g=Object(n.useState)(!1),E=Object(p.a)(g,2),v=E[0],y=E[1];return Object(n.useEffect)((function(){var t=function(){var t=Object(m.a)(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(x,"/").concat(e),t.next=3,k({url:a,method:"GET"});case 3:if(n=t.sent,o({status:!1}),y(!0),!(n instanceof Error)){t.next=8;break}return t.abrupt("return");case 8:h(n);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=setTimeout((function(){return t()}),400);return function(){clearTimeout(a)}}),[e]),r.a.createElement(r.a.Fragment,null,!v||b&&r.a.createElement(d.a,{as:"h2",content:"Scan Results",className:"light-header"}),r.a.createElement(N,{loading:c.status,loadingProps:{size:"huge",content:"Populating Results..."}},v&&!b&&r.a.createElement(be,null),b&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-section","data-testid":"single-scan"},r.a.createElement(d.a,{content:F()(1e3*b.start_time).format("MMM D, YYYY"),as:"h3"}),r.a.createElement(A,{title:"Hosts Scanned",value:(b.hosts_up+b.hosts_down).toString(),bold:!0,linebreak:!0}),r.a.createElement(A,{title:"Hosts Up",value:b.hosts_up.toString(),bold:!0,linebreak:!0}),r.a.createElement(A,{title:"Hosts Down",value:b.hosts_down.toString(),bold:!0,linebreak:!0})),r.a.createElement("br",null),r.a.createElement(l.b,{to:"/scans",className:"basic-link"},"Back to all scans"),r.a.createElement(fe,{hosts:b.hosts}),r.a.createElement(K,{scan:b}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(l.b,{to:"/scans",className:"basic-link"},"Back to all scans"))))},ge=function(){return r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/",exact:!0},r.a.createElement(W,null)),r.a.createElement(s.a,{path:"/scans",exact:!0},r.a.createElement(W,null)),r.a.createElement(s.a,{path:"/scans/:id",exact:!0},r.a.createElement(he,null)),r.a.createElement(s.a,{path:"*"},r.a.createElement(be,null)))};o.a.render(r.a.createElement(l.a,null,r.a.createElement("div",{className:"width-wrapper"},r.a.createElement(ge,null))),document.getElementById("root"))}},[[248,1,2]]]);
//# sourceMappingURL=main.63129033.chunk.js.map